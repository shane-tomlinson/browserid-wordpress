/*jshint browser: true*//*global jQuery, wp*//* This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. */(function(){function c(a){if(document.location.protocol==="https://")return a;var b=document.createElement("canvas");if(!b)return a;var c=document.createElement("img");c.src=a,document.body.appendChild(c),b.width=c.width,b.height=c.height;var d=b.getContext("2d");d.drawImage(c,0,0);var e=b.toDataURL("image/png");return document.body.removeChild(c),e}"use strict";var a=jQuery;a(".js-persona__color-picker").wpColorPicker();var b={};a(".js-persona__file-picker").click(function(d){d.preventDefault();var e=a(d.target),f=e.attr("for"),g=b[f];if(g)return g.open();var h={className:"media-frame js-persona__media-frame",frame:"select",multiple:!1,title:e.attr("data-title")||"",input:a("#"+e.attr("for"))},i=e.attr("data-type");i&&(h.library={type:i}),g=b[f]=wp.media(h),g.on("select",function(){var a=g.state().get("selection").first().toJSON(),b=a.url;i==="image"&&(b=c(b)),h.input.val(b)}),g.open()})})()